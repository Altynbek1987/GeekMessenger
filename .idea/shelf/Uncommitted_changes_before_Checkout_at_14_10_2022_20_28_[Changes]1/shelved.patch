Index: feature-main/src/main/java/com/geektechkb/feature_main/presentation/ui/fragments/chat/ChatFragment.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.geektechkb.feature_main.presentation.ui.fragments.chat\r\n\r\nimport android.Manifest\r\nimport android.net.Uri\r\nimport androidx.core.net.toUri\r\nimport androidx.core.view.isGone\r\nimport androidx.core.view.isVisible\r\nimport androidx.fragment.app.viewModels\r\nimport androidx.lifecycle.Lifecycle\r\nimport androidx.lifecycle.lifecycleScope\r\nimport androidx.lifecycle.repeatOnLifecycle\r\nimport androidx.navigation.fragment.findNavController\r\nimport androidx.navigation.fragment.navArgs\r\nimport androidx.recyclerview.widget.RecyclerView\r\nimport by.kirich1409.viewbindingdelegate.viewBinding\r\nimport com.geektechkb.common.constants.Constants.YEAR_MONTH_DAY_HOURS_MINUTES_SECONDS_DATE_FORMAT\r\nimport com.geektechkb.core.base.BaseFragment\r\nimport com.geektechkb.core.data.local.preferences.UserPreferencesHelper\r\nimport com.geektechkb.core.extensions.*\r\nimport com.geektechkb.core.ui.customViews.AudioRecordView\r\nimport com.geektechkb.core.utils.AppVoiceRecorder\r\nimport com.geektechkb.feature_main.R\r\nimport com.geektechkb.feature_main.databinding.FragmentChatBinding\r\nimport com.geektechkb.feature_main.presentation.ui.adapters.GalleryPicturesAdapter\r\nimport com.geektechkb.feature_main.presentation.ui.adapters.MessagesAdapter\r\nimport com.geektechkb.feature_main.presentation.ui.fragments.gallerydialogbotomsheet.GalleryBottomSheetViewModel\r\nimport com.google.android.material.bottomsheet.BottomSheetBehavior\r\nimport com.google.android.material.card.MaterialCardView\r\nimport com.vanniktech.emoji.EmojiPopup\r\nimport dagger.hilt.android.AndroidEntryPoint\r\nimport kotlinx.coroutines.flow.collectLatest\r\nimport kotlinx.coroutines.launch\r\nimport javax.inject.Inject\r\n\r\n\r\n@AndroidEntryPoint\r\nclass ChatFragment : BaseFragment<FragmentChatBinding, ChatViewModel>(R.layout.fragment_chat),\r\n    AudioRecordView.Callback {\r\n\r\n    override val binding by viewBinding(FragmentChatBinding::bind)\r\n    private var bottomSheetBehavior: BottomSheetBehavior<MaterialCardView>? = null\r\n    private val adapter = GalleryPicturesAdapter(this::onSelect)\r\n    private val messagesAdapter = MessagesAdapter()\r\n    override val viewModel by viewModels<ChatViewModel>()\r\n    private val galleryViewModel: GalleryBottomSheetViewModel by viewModels()\r\n    private val args: ChatFragmentArgs by navArgs()\r\n    private var username: String? = null\r\n    private var imageUri = Uri.EMPTY\r\n    private var stateBottomSheet: Boolean = false\r\n    private val appVoiceRecorder = AppVoiceRecorder()\r\n    private val recordAudioPermissionLauncher =\r\n        createRequestPermissionLauncherToRequestSinglePermission(Manifest.permission.RECORD_AUDIO)\r\n    private val readExternalStoragePermissionLauncher =\r\n        createRequestPermissionLauncherToRequestSinglePermission(\r\n            Manifest.permission.READ_EXTERNAL_STORAGE, actionWhenPermissionHasBeenGranted = {\r\n                setupBottomSheet()\r\n            },\r\n            actionWhenPermissionHasBeenDenied = {\r\n                if (findNavController().currentDestination?.id != R.id.deniedPermissionsDialogFragment)\r\n                    findNavController().directionsSafeNavigation(\r\n                        ChatFragmentDirections.actionChatFragmentToDeniedPermissionsDialogFragment(\r\n                            getString(com.geektechkb.core.R.string.geekMessenger_application_cant_function_without_needed_permissions_russian)\r\n                        )\r\n                    )\r\n            })\r\n\r\n    @Inject\r\n    lateinit var usersPreferencesHelper: UserPreferencesHelper\r\n\r\n    override fun initialize() {\r\n        galleryViewModel.shouldVideoBeShown(true)\r\n        binding.recordView.activity = requireActivity()\r\n        binding.recordView.callback = this\r\n        appVoiceRecorder.createFileForRecordedVoiceMessage(requireContext().getExternalFilesDir(null))\r\n    }\r\n\r\n    override fun assembleViews() {\r\n        setupAdapter()\r\n        hideClipAndRecordViewWhenUserTyping()\r\n    }\r\n\r\n    private fun changeUserStatusToTyping(receiverPhoneNumber: String?) {\r\n        binding.apply {\r\n            binding.etMessage.addTextChangedListenerAnonymously(doSomethingOnTextChanged = {\r\n                if (usersPreferencesHelper.currentUserPhoneNumber != receiverPhoneNumber) {\r\n                    tvUserStatus.isVisible = false\r\n                    tvTyping.isVisible = true\r\n                }\r\n            }, doSomethingAfterTextChanged = {\r\n                tvUserStatus.isVisible = true\r\n                tvTyping.isVisible = false\r\n            })\r\n        }\r\n    }\r\n\r\n    private fun checkAdapterItemCountAndHideLayout() {\r\n        when (messagesAdapter.itemCount) {\r\n            0 -> binding.iThereAreNoMessagesYet.root.isVisible = true\r\n            else -> binding.iThereAreNoMessagesYet.root.isVisible = false\r\n        }\r\n    }\r\n\r\n    private fun setupAdapter() {\r\n        binding.recyclerview.adapter = messagesAdapter\r\n    }\r\n\r\n    private fun hideClipAndRecordViewWhenUserTyping() = with(binding) {\r\n        etMessage.addTextChangedListenerAnonymously(doSomethingOnTextChanged = {\r\n            when (etMessage.text?.length) {\r\n                0 -> {\r\n                    recordView.isGone = false\r\n                    imSendMessage.isGone = true\r\n                    imClip.isVisible = true\r\n                }\r\n                else -> {\r\n                    recordView.isGone = true\r\n                    imSendMessage.isGone = false\r\n                    imClip.isVisible = false\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    override fun setupListeners() {\r\n        sendMessage()\r\n        expandGalleryDialog()\r\n        openEmojiSoftKeyboard()\r\n        interactWithToolbarMenu()\r\n        backToHomeFragment()\r\n        onBackPressed()\r\n    }\r\n\r\n    private fun expandGalleryDialog() {\r\n        if (stateBottomSheet) {\r\n            initBottomSheetRecycler()\r\n            openBottomSheet()\r\n        }\r\n        binding.imClip.setOnSingleClickListener {\r\n            checkForPermissionStatusAndRequestIt(\r\n                readExternalStoragePermissionLauncher,\r\n                Manifest.permission.READ_EXTERNAL_STORAGE,\r\n                actionWhenPermissionHasBeenGranted = {\r\n                    initBottomSheetRecycler()\r\n                    openBottomSheet()\r\n                    setupBottomSheet()\r\n                })\r\n        }\r\n    }\r\n\r\n    private fun openBottomSheet() {\r\n        binding.apply {\r\n            openGalleryBottomSheet(\r\n                galleryBottomSheet.galleryBottomSheetDialog,\r\n                bottomSheetBehavior,\r\n                galleryBottomSheet.appbarLayout,\r\n                coordinatorGallery,\r\n                actionOnDialogStateDragging = {\r\n                    recordView.isVisible = false\r\n                }, actionOnDialogStateExpanded = {\r\n                    recordView.isVisible = false\r\n                }, actionOnDialogStateHidden = {\r\n                    recordView.isVisible = true\r\n                }\r\n            )\r\n        }\r\n    }\r\n\r\n    private fun setupBottomSheet() {\r\n        bottomSheetBehavior =\r\n            BottomSheetBehavior.from(binding.galleryBottomSheet.galleryBottomSheetDialog)\r\n    }\r\n\r\n    private fun initBottomSheetRecycler() {\r\n        binding.galleryBottomSheet.recyclerviewRating.adapter = adapter\r\n        binding.galleryBottomSheet.recyclerviewRating.addOnScrollListener(object :\r\n            RecyclerView.OnScrollListener() {\r\n            override fun onScrolled(recyclerView: RecyclerView, dx: Int, dy: Int) {\r\n                loadPictures()\r\n            }\r\n        })\r\n        loadPictures()\r\n    }\r\n\r\n    private fun loadPictures() {\r\n        galleryViewModel.getImagesFromGallery(context = requireContext(), pageSize = 10) {\r\n            if (it.isNotEmpty()) {\r\n                val mutableAdapterList = adapter.currentList.toMutableList()\r\n                mutableAdapterList.addAll(it)\r\n                adapter.submitList(mutableAdapterList)\r\n                adapter.notifyItemRangeInserted(adapter.currentList.size, it.size)\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun onBackPressed() {\r\n        overrideOnBackPressed {\r\n            if (checkWhetherSoftKeyboardIsVisibleOrNot()) {\r\n                hideSoftKeyboard()\r\n            } else {\r\n                findNavController().navigateSafely(R.id.action_chatFragment_to_homeFragment)\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun sendMessage() = with(binding) {\r\n        imSendMessage.setOnSingleClickListener {\r\n            viewModel.sendMessage(\r\n                usersPreferencesHelper.currentUserPhoneNumber,\r\n                args.phoneNumber.toString(),\r\n                etMessage.text.toString(),\r\n                \"\",\r\n                formatCurrentUserTime(YEAR_MONTH_DAY_HOURS_MINUTES_SECONDS_DATE_FORMAT),\r\n                generateRandomId()\r\n            )\r\n            etMessage.text?.clear()\r\n        }\r\n    }\r\n\r\n    private fun interactWithToolbarMenu() {\r\n        binding.toolbar.setOnMenuItemClickListener {\r\n            when (it.itemId) {\r\n\r\n                R.id.btn_call -> {\r\n                    true\r\n                }\r\n                R.id.btn_video_call -> {\r\n                    true\r\n                }\r\n                R.id.btn_clear_chat -> {\r\n                    findNavController().directionsSafeNavigation(\r\n                        ChatFragmentDirections.actionChatFragmentToClearChatHistoryFragment(\r\n                            username.toString()\r\n                        )\r\n                    )\r\n                    true\r\n                }\r\n                R.id.btn_mute -> {\r\n                    true\r\n                }\r\n                else -> true\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun backToHomeFragment() {\r\n        binding.imBack.setOnSingleClickListener {\r\n            findNavController().navigate(R.id.action_chatFragment_to_homeFragment)\r\n        }\r\n    }\r\n\r\n    private fun openEmojiSoftKeyboard() {\r\n        binding.apply {\r\n            val emojiPopUp = EmojiPopup(\r\n                root,\r\n                binding.etMessage,\r\n                onEmojiPopupShownListener = { binding.imEmoji.setImageResource(R.drawable.ic_keyboard) },\r\n                onEmojiPopupDismissListener = { binding.imEmoji.setImageResource(R.drawable.ic_emoji) },\r\n            )\r\n            binding.imEmoji.setOnSingleClickListener {\r\n                emojiPopUp.toggle()\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun establishRequest() {\r\n        fetchUser()\r\n    }\r\n\r\n    private fun fetchUser() {\r\n        viewLifecycleOwner.lifecycleScope.launchWhenStarted {\r\n            args.phoneNumber?.let { viewModel.fetchUser(it) }\r\n        }\r\n    }\r\n\r\n    override fun launchObservers() {\r\n        subscribeToUser()\r\n        subscribeToMessages()\r\n    }\r\n\r\n    private fun subscribeToUser() {\r\n        viewModel.userState.spectateUiState(success = {\r\n            changeUserStatusToTyping(it.phoneNumber)\r\n            binding.imProfile.loadImageWithGlide(it.profileImage)\r\n            binding.tvUsername.text = it.name\r\n            binding.tvUserStatus.text = it.lastSeen\r\n            username = it.name\r\n        })\r\n    }\r\n\r\n    private fun subscribeToMessages() {\r\n        viewLifecycleOwner.lifecycleScope.launch {\r\n            viewLifecycleOwner.repeatOnLifecycle(Lifecycle.State.STARTED) {\r\n                args.phoneNumber?.let { receiverPhoneNumber ->\r\n                    viewModel.fetchPagedMessages(\r\n                        usersPreferencesHelper.currentUserPhoneNumber,\r\n                        receiverPhoneNumber\r\n                    ).collectLatest {\r\n                        messagesAdapter.setPhoneNumber(\r\n                            usersPreferencesHelper.currentUserPhoneNumber, receiverPhoneNumber\r\n                        )\r\n                        messagesAdapter.submitList(it)\r\n                        checkAdapterItemCountAndHideLayout()\r\n                        binding.recyclerview.scrollToPosition(messagesAdapter.itemCount - 1)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private fun onSelect(uri: Uri) {\r\n        imageUri = uri\r\n        stateBottomSheet = true\r\n        findNavController().navigate(\r\n            ChatFragmentDirections.actionChatFragmentToPhotoReviewFragment(\r\n                args.phoneNumber.toString(),\r\n                uri.toString()\r\n            )\r\n        )\r\n    }\r\n\r\n    override fun onRecordStart() {\r\n        checkForPermissionStatusAndRequestIt(\r\n            recordAudioPermissionLauncher,\r\n            Manifest.permission.RECORD_AUDIO,\r\n            actionWhenPermissionHasBeenGranted = {\r\n                appVoiceRecorder.startRecordingVoiceMessage(requireContext())\r\n            })\r\n    }\r\n\r\n    override fun isReady(): Boolean = true\r\n\r\n    override fun onRecordEnd() {\r\n        appVoiceRecorder.stopRecordingVoiceMessage()\r\n        viewModel.sendVoiceMessage(\r\n            appVoiceRecorder.retrieveVoiceMessageFile().toUri().toString(),\r\n            generateRandomId()\r\n        )\r\n    }\r\n\r\n    override fun onRecordCancel() {\r\n        appVoiceRecorder.deleteRecordedVoiceMessage()\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/feature-main/src/main/java/com/geektechkb/feature_main/presentation/ui/fragments/chat/ChatFragment.kt b/feature-main/src/main/java/com/geektechkb/feature_main/presentation/ui/fragments/chat/ChatFragment.kt
--- a/feature-main/src/main/java/com/geektechkb/feature_main/presentation/ui/fragments/chat/ChatFragment.kt	
+++ b/feature-main/src/main/java/com/geektechkb/feature_main/presentation/ui/fragments/chat/ChatFragment.kt	
@@ -314,7 +314,6 @@
         findNavController().navigate(
             ChatFragmentDirections.actionChatFragmentToPhotoReviewFragment(
                 args.phoneNumber.toString(),
-                uri.toString()
             )
         )
     }
Index: core/src/main/java/com/geektechkb/core/extensions/UIExtensions.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.geektechkb.core.extensions\r\n\r\nimport android.graphics.Color\r\nimport android.text.SpannableStringBuilder\r\nimport android.widget.ImageView\r\nimport android.widget.ProgressBar\r\nimport androidx.core.view.isVisible\r\nimport com.bumptech.glide.Glide\r\nimport com.bumptech.glide.load.resource.drawable.DrawableTransitionOptions\r\nimport com.google.android.material.switchmaterial.SwitchMaterial\r\nimport io.getstream.avatarview.AvatarView\r\nimport io.getstream.avatarview.coil.loadImage\r\nimport kotlin.random.Random\r\n\r\nfun ImageView.loadImageWithGlide(url: Any?) =\r\n    Glide.with(this).load(url).into(this)\r\n\r\nfun ImageView.setImage(uri: String) = Glide.with(this).load(uri)\r\n    .circleCrop().transition(DrawableTransitionOptions.withCrossFade()).into(this)\r\n\r\nfun ImageView.changeIconWhenActivated(vararg imageViews: ImageView) {\r\n    setOnClickListener {\r\n        isActivated = !isActivated\r\n    }\r\n    imageViews.forEach { imageView ->\r\n        imageView.setOnClickListener {\r\n            imageView.isActivated = !imageView.isActivated\r\n        }\r\n    }\r\n}\r\n\r\nfun SwitchMaterial.actionOnCheckedChange(action: (Boolean) -> Unit) {\r\n    setOnCheckedChangeListener { _, isChecked ->\r\n        action(isChecked)\r\n    }\r\n}\r\n\r\nfun AvatarView.loadImageAndSetInitialsIfFailed(\r\n    url: String?,\r\n    name: String?,\r\n    progressBar: ProgressBar,\r\n    avatarBackgroundColor: Int = Color.rgb(\r\n        Random.nextInt(255),\r\n        Random.nextInt(255),\r\n        Random.nextInt(255)\r\n    )\r\n) {\r\n    loadImage(data = url, onError = { _, _ ->\r\n        avatarInitialsBackgroundColor = avatarBackgroundColor\r\n        avatarInitials = SpannableStringBuilder(\r\n            name.takeFirstCharacterAndCapitalizeIt()\r\n        ).toString()\r\n\r\n    }, onStart = {\r\n        progressBar.isVisible = true\r\n    }, onComplete = {\r\n        progressBar.isVisible = false\r\n    })\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/core/src/main/java/com/geektechkb/core/extensions/UIExtensions.kt b/core/src/main/java/com/geektechkb/core/extensions/UIExtensions.kt
--- a/core/src/main/java/com/geektechkb/core/extensions/UIExtensions.kt	
+++ b/core/src/main/java/com/geektechkb/core/extensions/UIExtensions.kt	
@@ -38,19 +38,47 @@
 fun AvatarView.loadImageAndSetInitialsIfFailed(
     url: String?,
     name: String?,
-    progressBar: ProgressBar,
-    avatarBackgroundColor: Int = Color.rgb(
-        Random.nextInt(255),
-        Random.nextInt(255),
-        Random.nextInt(255)
-    )
+    lastName: String? = null,
+    progressBar: ProgressBar
 ) {
     loadImage(data = url, onError = { _, _ ->
-        avatarInitialsBackgroundColor = avatarBackgroundColor
+
+        val random = Random
+        val randomAvatarBackgroundColor =
+            Color.rgb(
+                random.nextInt(255),
+                random.nextInt(255),
+                random.nextInt(255)
+            )
+        avatarInitialsBackgroundColor = randomAvatarBackgroundColor
+        avatarInitials = SpannableStringBuilder(
+            name.takeFirstCharacterAndCapitalizeIt()
+        ).append(lastName.takeFirstCharacterAndCapitalizeIt()).toString()
+    }, onStart = {
+        progressBar.isVisible = true
+    }, onComplete = {
+        progressBar.isVisible = false
+    })
+}
+
+fun AvatarView.loadImageAndSetInitialsIfFailed(
+    url: String?,
+    name: String?,
+    progressBar: ProgressBar
+) {
+    loadImage(data = url, onError = { _, _ ->
+
+        val random = Random
+        val randomAvatarBackgroundColor =
+            Color.rgb(
+                random.nextInt(255),
+                random.nextInt(255),
+                random.nextInt(255)
+            )
+        avatarInitialsBackgroundColor = randomAvatarBackgroundColor
         avatarInitials = SpannableStringBuilder(
             name.takeFirstCharacterAndCapitalizeIt()
         ).toString()
-
     }, onStart = {
         progressBar.isVisible = true
     }, onComplete = {
Index: feature-main/src/main/res/navigation/profile_graph.xml
===================================================================
diff --git a/feature-main/src/main/res/navigation/profile_graph.xml b/feature-main/src/main/res/navigation/profile_graph.xml
deleted file mode 100644
--- a/feature-main/src/main/res/navigation/profile_graph.xml	
+++ /dev/null	
@@ -1,90 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<navigation xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://schemas.android.com/apk/res-auto"
-    xmlns:tools="http://schemas.android.com/tools"
-    android:id="@+id/profile_graph"
-    app:startDestination="@id/profileFragment">
-
-    <fragment
-        android:id="@+id/editProfileFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.editProfile.EditProfileFragment"
-        android:label="fragment_edit_profile"
-        tools:layout="@layout/fragment_edit_profile">
-        <action
-            android:id="@+id/action_editProfileFragment_to_cropPhotoFragment"
-            app:destination="@id/cropPhotoFragment" />
-
-        <argument
-            android:name="croppedProfileAvatar"
-            android:defaultValue="@null"
-            app:argType="string"
-            app:nullable="true" />
-    </fragment>
-    <fragment
-        android:id="@+id/profileFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.profile.ProfileFragment"
-        tools:layout="@layout/fragment_profile">
-
-        <action
-            android:id="@+id/action_profileFragment_to_cropPhotoFragment"
-            app:destination="@id/cropPhotoFragment" />
-
-        <action
-            android:id="@+id/action_profileFragment_to_languagesFragment"
-            app:destination="@id/languagesFragment" />
-        <action
-            android:id="@+id/action_profileFragment_to_notificationsAndSoundsFragment"
-            app:destination="@id/notificationsAndSoundsFragment" />
-        <action
-            android:id="@+id/action_profileFragment_to_editProfileFragment"
-            app:destination="@id/editProfileFragment" />
-        <argument
-            android:name="croppedImage"
-            android:defaultValue="@null"
-            app:argType="string"
-            app:nullable="true" />
-        <action
-            android:id="@+id/action_profileFragment_to_mainFlowFragment"
-            app:destination="@id/mainFlowFragment"
-            app:popUpTo="@id/profile_graph"
-            app:popUpToInclusive="true" />
-    </fragment>
-
-    <fragment
-        android:id="@+id/cropPhotoFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.crop.CropPhotoFragment"
-        android:label="fragment_crop_photo"
-        tools:layout="@layout/fragment_crop_photo">
-        <argument
-            android:name="uri"
-            app:argType="string" />
-        <action
-            android:id="@+id/action_cropPhotoFragment_to_profileFragment"
-            app:destination="@id/profileFragment"
-            app:popUpTo="@id/profile_graph"
-            app:popUpToInclusive="true" />
-        <action
-            android:id="@+id/action_cropPhotoFragment_to_editProfileFragment"
-            app:destination="@id/editProfileFragment"
-            app:popUpTo="@id/profileFragment" />
-        <argument
-            android:name="whereToNavigateBack"
-            app:argType="com.geektechkb.feature_main.presentation.ui.models.enums.CropPhotoRequest" />
-
-    </fragment>
-    <fragment
-        android:id="@+id/languagesFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.language.LanguagesFragment"
-        android:label="fragment_languages"
-        tools:layout="@layout/fragment_languages" />
-    <fragment
-        android:id="@+id/notificationsAndSoundsFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.notificationsAndSounds.NotificationsAndSoundsFragment"
-        android:label="fragment_notifications_and_sounds"
-        tools:layout="@layout/fragment_notifications_and_sounds" />
-    <fragment
-        android:id="@+id/mainFlowFragment"
-        android:name="com.geektechkb.feature_main.presentation.MainFlowFragment"
-        android:label="fragment_main_flow"
-        tools:layout="@layout/fragment_main_flow" />
-</navigation>
\ No newline at end of file
Index: feature-auth/src/main/res/navigation/authorization_graph.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<navigation xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/authorization_graph\"\r\n    app:startDestination=\"@id/onBoardFragment\">\r\n    <fragment\r\n        android:id=\"@+id/signUpFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.signUp.SignUpFragment\"\r\n        android:label=\"fragment_sign_up\"\r\n        tools:layout=\"@layout/fragment_sign_up\">\r\n        <action\r\n            android:id=\"@+id/action_signUpFragment_to_phoneVerificationDialogFragment\"\r\n            app:destination=\"@id/phoneVerificationDialogFragment\" />\r\n    </fragment>\r\n    <dialog\r\n        android:id=\"@+id/phoneVerificationDialogFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.signUp.PhoneVerificationDialogFragment\"\r\n        android:label=\"fragment_phone_verification_dialog\"\r\n        tools:layout=\"@layout/fragment_phone_verification_dialog\">\r\n        <action\r\n            android:id=\"@+id/action_phoneVerificationDialogFragment_to_verifyAuthenticationFragment\"\r\n            app:destination=\"@id/verifyAuthenticationFragment\"\r\n            app:popUpTo=\"@id/signUpFragment\"\r\n            app:popUpToInclusive=\"true\" />\r\n        <argument\r\n            android:name=\"inputPhoneNumber\"\r\n            app:argType=\"string\" />\r\n    </dialog>\r\n    <fragment\r\n        android:id=\"@+id/verifyAuthenticationFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.verification.VerifyAuthenticationFragment\"\r\n        android:label=\"fragment_verify_authentication\"\r\n        tools:layout=\"@layout/fragment_verify_authentication\">\r\n        <argument\r\n            android:name=\"phoneNumber\"\r\n            app:argType=\"string\" />\r\n\r\n        <action\r\n            android:id=\"@+id/action_verifyAuthenticationFragment_to_createProfileFragment\"\r\n            app:destination=\"@id/createProfileFragment\"\r\n            app:popUpTo=\"@id/authorization_graph\"\r\n            app:popUpToInclusive=\"true\" />\r\n        <action\r\n            android:id=\"@+id/action_verifyAuthenticationFragment_to_signUpFragment\"\r\n            app:destination=\"@id/signUpFragment\" />\r\n\r\n\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/createProfileFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.createProfile.CreateProfileFragment\"\r\n        android:label=\"fragment_profile\"\r\n        tools:layout=\"@layout/fragment_create_profile\">\r\n        <action\r\n            android:id=\"@+id/action_profileFragment_to_mainFlowFragment\"\r\n            app:destination=\"@id/mainFlowFragment\"\r\n            app:popUpTo=\"@id/authorization_graph\" />\r\n        <action\r\n            android:id=\"@+id/action_createProfileFragment_to_deniedPermissionsDialogFragment\"\r\n            app:destination=\"@id/deniedPermissionsDialogFragment\" />\r\n        <argument\r\n            android:name=\"phoneNumber\"\r\n            android:defaultValue=\"\"\r\n            app:argType=\"string\" />\r\n    </fragment>\r\n\r\n\r\n    <fragment\r\n        android:id=\"@+id/mainFlowFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.MainFlowFragment\"\r\n        android:label=\"MainFlowFragment\">\r\n\r\n    </fragment>\r\n    <dialog\r\n        android:id=\"@+id/deniedPermissionsDialogFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.createProfile.DeniedPermissionsDialogFragment\"\r\n        android:label=\"fragment_denied_permissions_dialog\"\r\n        tools:layout=\"@layout/fragment_denied_permissions_dialog\">\r\n        <argument\r\n            android:name=\"text\"\r\n            app:argType=\"string\" />\r\n    </dialog>\r\n    <dialog\r\n        android:id=\"@+id/attemptsToVerifyPhoneNumberExceededDialogFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.verification.AttemptsToVerifyPhoneNumberExceededDialogFragment\"\r\n        android:label=\"fragment_verification_dialog\"\r\n        tools:layout=\"@layout/fragment_attempts_to_verify_phone_number_exceeded_dialog\">\r\n\r\n    </dialog>\r\n\r\n    <fragment\r\n        android:id=\"@+id/onBoardFragment\"\r\n        android:name=\"com.geektechkb.feature_auth.presentation.ui.fragments.auth.onboard.OnBoardFragment\"\r\n        android:label=\"fragment_on_board\"\r\n        tools:layout=\"@layout/fragment_on_board\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_onBoardFragment_to_signUpFragment\"\r\n            app:destination=\"@id/signUpFragment\"\r\n            app:popUpTo=\"@id/authorization_graph\" />\r\n    </fragment>\r\n\r\n</navigation>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/feature-auth/src/main/res/navigation/authorization_graph.xml b/feature-auth/src/main/res/navigation/authorization_graph.xml
--- a/feature-auth/src/main/res/navigation/authorization_graph.xml	
+++ b/feature-auth/src/main/res/navigation/authorization_graph.xml	
@@ -3,7 +3,7 @@
     xmlns:app="http://schemas.android.com/apk/res-auto"
     xmlns:tools="http://schemas.android.com/tools"
     android:id="@+id/authorization_graph"
-    app:startDestination="@id/onBoardFragment">
+    app:startDestination="@id/createProfileFragment">
     <fragment
         android:id="@+id/signUpFragment"
         android:name="com.geektechkb.feature_auth.presentation.ui.fragments.auth.signUp.SignUpFragment"
Index: feature-main/src/main/java/com/geektechkb/feature_main/presentation/MainFlowFragment.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.geektechkb.feature_main.presentation\r\n\r\nimport android.annotation.SuppressLint\r\nimport androidx.appcompat.app.AppCompatDelegate\r\nimport androidx.core.view.GravityCompat\r\nimport androidx.core.view.isGone\r\nimport androidx.drawerlayout.widget.DrawerLayout\r\nimport androidx.fragment.app.viewModels\r\nimport androidx.navigation.NavController\r\nimport androidx.navigation.ui.AppBarConfiguration\r\nimport androidx.navigation.ui.setupWithNavController\r\nimport by.kirich1409.viewbindingdelegate.viewBinding\r\nimport com.geektechkb.common.constants.Constants.DAY_MONTH_YEAR_HOURS_AND_MINUTES_DATE_FORMAT\r\nimport com.geektechkb.common.constants.Constants.HOURS_MINUTES_DATE_FORMAT\r\nimport com.geektechkb.core.base.BaseFlowFragment\r\nimport com.geektechkb.core.data.local.preferences.UserPreferencesHelper\r\nimport com.geektechkb.core.extensions.formatCurrentUserTime\r\nimport com.geektechkb.core.extensions.loadImageAndSetInitialsIfFailed\r\nimport com.geektechkb.core.extensions.overrideOnBackPressed\r\nimport com.geektechkb.feature_main.R\r\nimport com.geektechkb.feature_main.data.local.preferences.PreferencesHelper\r\nimport com.geektechkb.feature_main.databinding.FragmentMainFlowBinding\r\nimport dagger.hilt.android.AndroidEntryPoint\r\nimport javax.inject.Inject\r\n\r\n@AndroidEntryPoint\r\nclass MainFlowFragment : BaseFlowFragment(\r\n    R.layout.fragment_main_flow,\r\n    R.id.nav_host_fragment_content_main,\r\n) {\r\n    private lateinit var appBarConfiguration: AppBarConfiguration\r\n    private val binding by viewBinding(FragmentMainFlowBinding::bind)\r\n    private val viewModel: MainFlowViewModel by viewModels()\r\n    private var userStatus: String? = null\r\n\r\n    @Inject\r\n    lateinit var preferences: UserPreferencesHelper\r\n\r\n    @Inject\r\n    lateinit var preferencesHelper: PreferencesHelper\r\n\r\n    override fun assembleViews() {\r\n        if (!preferencesHelper.isLightMode) {\r\n            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES)\r\n            binding.nav.sunBtn.setImageResource(R.drawable.ic_sun)\r\n        } else {\r\n            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n            binding.nav.sunBtn.setImageResource(R.drawable.ic_baseline_nights_stay_24)\r\n        }\r\n    }\r\n\r\n    @SuppressLint(\"ResourceType\")\r\n    override fun setupNavigation(navController: NavController) {\r\n\r\n        val drawerLayout: DrawerLayout = binding.drawerLayout\r\n        appBarConfiguration = AppBarConfiguration(\r\n            setOf(\r\n                R.id.homeFragment,\r\n                R.id.nav_groups, R.id.nav_calls, R.id.profileFlowFragment,\r\n\r\n                ), binding.drawerLayout\r\n        )\r\n        binding.navView.setupWithNavController(navController)\r\n        navController.addOnDestinationChangedListener { _, destination, _ ->\r\n            when (destination.id) {\r\n                R.id.chatFragment, R.id.voiceCallFragment, R.id.incomingCallFragment, R.id.nav_groups, R.id.nav_calls, R.id.profileFlowFragment, R.id.profileFragment -> binding.homeAppBarMain.toolbarButton.isGone =\r\n                    true\r\n\r\n                else -> binding.homeAppBarMain.toolbarButton.isGone = false\r\n            }\r\n        }\r\n        binding.homeAppBarMain.toolbarButton.setOnClickListener {\r\n            drawerLayout.openDrawer(GravityCompat.START)\r\n        }\r\n    }\r\n\r\n            binding.homeAppBarMain.toolbarButton.setOnClickListener {\r\n                binding.drawerLayout.openDrawer(GravityCompat.START)\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun setupListeners() {\r\n        overrideOnBackPressed {\r\n            requireActivity().finish()\r\n        }\r\n    }\r\n    override fun setupListeners() {\r\n        binding.nav.sunBtn.setOnClickListener {\r\n            if (!preferencesHelper.isLightMode) {\r\n                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO)\r\n                binding.nav.sunBtn.setImageResource(R.drawable.ic_baseline_nights_stay_24)\r\n                preferencesHelper.isLightMode = true\r\n            } else {\r\n                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES)\r\n                binding.nav.sunBtn.setImageResource(R.drawable.ic_sun)\r\n                preferencesHelper.isLightMode = false\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun establishRequest() {\r\n        fetchUser()\r\n    }\r\n\r\n    private fun fetchUser() {\r\n        viewModel.fetchUser(preferences.currentUserPhoneNumber)\r\n    }\r\n\r\n    override fun launchObservers() {\r\n        subscribeToUser()\r\n    }\r\n\r\n    private fun subscribeToUser() = with(binding.nav) {\r\n        viewModel.userState.spectateUiState(success = { user ->\r\n            user.apply {\r\n                userStatus = user.lastSeen\r\n                userNumber.text = getString(\r\n                    R.string.plus, phoneNumber?.substringAfter(\r\n                        \"+\"\r\n                    )?.chunked(3)?.joinToString(\" \")\r\n                )\r\n                avatarView.loadImageAndSetInitialsIfFailed(\r\n                    profileImage,\r\n                    name,\r\n                    binding.nav.cpiCurrentUserAvatar\r\n                )\r\n                userName.text = name\r\n            }\r\n        })\r\n    }\r\n\r\n    override fun onStart() {\r\n        super.onStart()\r\n        viewModel.updateUserStatus(\"в сети\")\r\n    }\r\n\r\n    override fun onStop() {\r\n        super.onStop()\r\n        viewModel.updateUserStatus(\r\n            \"был(а) в ${\r\n                formatCurrentUserTime(\r\n                    DAY_MONTH_YEAR_HOURS_AND_MINUTES_DATE_FORMAT\r\n                ).format(HOURS_MINUTES_DATE_FORMAT)\r\n            }\"\r\n        )\r\n    }\r\n    //puoioufuf\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/feature-main/src/main/java/com/geektechkb/feature_main/presentation/MainFlowFragment.kt b/feature-main/src/main/java/com/geektechkb/feature_main/presentation/MainFlowFragment.kt
--- a/feature-main/src/main/java/com/geektechkb/feature_main/presentation/MainFlowFragment.kt	
+++ b/feature-main/src/main/java/com/geektechkb/feature_main/presentation/MainFlowFragment.kt	
@@ -16,7 +16,6 @@
 import com.geektechkb.core.data.local.preferences.UserPreferencesHelper
 import com.geektechkb.core.extensions.formatCurrentUserTime
 import com.geektechkb.core.extensions.loadImageAndSetInitialsIfFailed
-import com.geektechkb.core.extensions.overrideOnBackPressed
 import com.geektechkb.feature_main.R
 import com.geektechkb.feature_main.data.local.preferences.PreferencesHelper
 import com.geektechkb.feature_main.databinding.FragmentMainFlowBinding
@@ -72,19 +71,11 @@
         binding.homeAppBarMain.toolbarButton.setOnClickListener {
             drawerLayout.openDrawer(GravityCompat.START)
         }
-    }
-
-            binding.homeAppBarMain.toolbarButton.setOnClickListener {
-                binding.drawerLayout.openDrawer(GravityCompat.START)
-            }
+        binding.homeAppBarMain.toolbarButton.setOnClickListener {
+            binding.drawerLayout.openDrawer(GravityCompat.START)
         }
     }
 
-    override fun setupListeners() {
-        overrideOnBackPressed {
-            requireActivity().finish()
-        }
-    }
     override fun setupListeners() {
         binding.nav.sunBtn.setOnClickListener {
             if (!preferencesHelper.isLightMode) {
@@ -115,17 +106,25 @@
         viewModel.userState.spectateUiState(success = { user ->
             user.apply {
                 userStatus = user.lastSeen
-                userNumber.text = getString(
-                    R.string.plus, phoneNumber?.substringAfter(
-                        "+"
-                    )?.chunked(3)?.joinToString(" ")
-                )
-                avatarView.loadImageAndSetInitialsIfFailed(
+                phoneNumber?.let { phoneNumber ->
+                    userNumber.text = StringBuilder(phoneNumber.substring(0, 4)).append(" ")
+                        .append(phoneNumber.substringAfter("+996"))
+                }
+                name?.let { name ->
+                    userName.text = name
+                }
+                lastName?.let { lastName ->
+                    avatarView.loadImageAndSetInitialsIfFailed(
+                        profileImage,
+                        name,
+                        lastName,
+                        binding.nav.cpiCurrentUserAvatar
+                    )
+                } ?: avatarView.loadImageAndSetInitialsIfFailed(
                     profileImage,
                     name,
                     binding.nav.cpiCurrentUserAvatar
                 )
-                userName.text = name
             }
         })
     }
@@ -145,5 +144,4 @@
             }"
         )
     }
-    //puoioufuf
 }
\ No newline at end of file
Index: feature-main/src/main/res/navigation/main_graph.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<navigation xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:id=\"@+id/main_graph\"\r\n    app:startDestination=\"@+id/homeFragment\">\r\n    <fragment\r\n        android:id=\"@+id/nav_groups\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.group.GroupFragment\"\r\n        android:label=\"@string/menu_group\"\r\n        tools:layout=\"@layout/fragment_group\" />\r\n\r\n    <fragment\r\n        android:id=\"@+id/nav_calls\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.calls.CallsFragment\"\r\n        android:label=\"@string/menu_calls\"\r\n        tools:layout=\"@layout/fragment_calls\" />\r\n\r\n    <fragment\r\n        android:id=\"@+id/homeFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.home.HomeFragment\"\r\n        android:label=\"fragment_home\"\r\n        tools:layout=\"@layout/fragment_home\">\r\n        <action\r\n            android:id=\"@+id/action_homeFragment_to_chatFragment\"\r\n            app:destination=\"@id/chatFragment\"\r\n            app:popUpTo=\"@id/main_graph\" />\r\n        <action\r\n            android:id=\"@+id/action_homeFragment_to_connectionCheckFragment\"\r\n            app:destination=\"@id/connectionCheckFragment\" />\r\n    </fragment>\r\n\r\n    <fragment\r\n        android:id=\"@+id/chatFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.chat.ChatFragment\"\r\n        android:label=\"fragment_chat\"\r\n        tools:layout=\"@layout/fragment_chat\">\r\n        <argument\r\n            android:name=\"phoneNumber\"\r\n            app:argType=\"string\"\r\n            app:nullable=\"true\" />\r\n        <argument\r\n            android:name=\"image\"\r\n            android:defaultValue=\"@null\"\r\n            app:argType=\"string\"\r\n            app:nullable=\"true\" />\r\n\r\n        <action\r\n            android:id=\"@+id/action_chatFragment_to_deniedPermissionsDialogFragment\"\r\n            app:destination=\"@id/deniedPermissionsDialogFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_chatFragment_to_clearChatHistoryFragment\"\r\n            app:destination=\"@id/clearChatHistoryFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_chatFragment_to_voiceCallFragment\"\r\n            app:destination=\"@id/voiceCallFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_chatFragment_to_photoReviewFragment\"\r\n            app:destination=\"@id/photoReviewFragment\" />\r\n        <action\r\n            android:id=\"@+id/action_chatFragment_to_homeFragment\"\r\n            app:destination=\"@id/homeFragment\"\r\n            app:popUpTo=\"@id/main_graph\"\r\n            app:popUpToInclusive=\"true\" />\r\n    </fragment>\r\n    <dialog\r\n        android:id=\"@+id/deniedPermissionsDialogFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.dialogs.DeniedPermissionsDialogFragment\"\r\n        android:label=\"DeniedPermissionsDialogFragment\"\r\n        tools:layout=\"@layout/fragment_denied_permissions_dialog\">\r\n        <argument\r\n            android:name=\"message\"\r\n            app:argType=\"string\" />\r\n    </dialog>\r\n    <dialog\r\n        android:id=\"@+id/clearChatHistoryFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.dialogs.ClearChatHistoryFragment\"\r\n        android:label=\"fragment_clear_chat_history\"\r\n        tools:layout=\"@layout/fragment_clear_chat_history\">\r\n        <argument\r\n            android:name=\"usernameToDeleteChatHistoryWith\"\r\n            app:argType=\"string\" />\r\n    </dialog>\r\n    <action\r\n        android:id=\"@+id/action_homeFragment_to_connectionCheckFragment\"\r\n        app:destination=\"@id/connectionCheckFragment\" />\r\n    <fragment\r\n        android:id=\"@+id/connectionCheckFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.checknetworkconnection.ConnectionCheckFragment\"\r\n        android:label=\"fragment_connection_check\"\r\n        tools:layout=\"@layout/fragment_connection_check\">\r\n\r\n        <action\r\n            android:id=\"@+id/action_connectionCheckFragment_to_homeFragment\"\r\n            app:destination=\"@id/homeFragment\" />\r\n    </fragment>\r\n\r\n    <fragment\r\n        android:id=\"@+id/voiceCallFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.calls.voice.VoiceCallFragment\"\r\n        android:label=\"fragment_voice_call\"\r\n        tools:layout=\"@layout/fragment_voice_call\">\r\n        <argument\r\n            android:name=\"username\"\r\n            app:argType=\"string\" />\r\n        <action\r\n            android:id=\"@+id/action_voiceCallFragment_to_incomingCallFragment\"\r\n            app:destination=\"@id/incomingCallFragment\" />\r\n    </fragment>\r\n    <fragment\r\n        android:id=\"@+id/incomingCallFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.calls.incoming.IncomingCallFragment\"\r\n        android:label=\"fragment_incoming_call\"\r\n        tools:layout=\"@layout/fragment_incoming_call\" />\r\n    <fragment\r\n        android:id=\"@+id/photoReviewFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.reviews.PhotoReviewFragment\"\r\n        android:label=\"fragment_photo_preview\"\r\n        tools:layout=\"@layout/fragment_photo_preview\">\r\n        <argument\r\n            android:name=\"phoneNumber\"\r\n            app:argType=\"string\" />\r\n        <argument\r\n            android:name=\"photo\"\r\n            app:argType=\"string\" />\r\n        <action\r\n            android:id=\"@+id/action_photoReviewFragment_to_chatFragment\"\r\n            app:destination=\"@id/chatFragment\"\r\n            app:popUpTo=\"@id/main_graph\"\r\n            app:popUpToInclusive=\"true\" />\r\n    </fragment>\r\n\r\n\r\n    <fragment\r\n        android:id=\"@+id/profileFlowFragment\"\r\n        android:name=\"com.geektechkb.feature_main.presentation.ui.fragments.profil.ProfileFlowFragment\"\r\n        android:label=\"ProfileFlowFragment\"\r\n        tools:layout=\"@layout/fragment_profile_flow\" />\r\n</navigation>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/feature-main/src/main/res/navigation/main_graph.xml b/feature-main/src/main/res/navigation/main_graph.xml
--- a/feature-main/src/main/res/navigation/main_graph.xml	
+++ b/feature-main/src/main/res/navigation/main_graph.xml	
@@ -4,6 +4,8 @@
     xmlns:tools="http://schemas.android.com/tools"
     android:id="@+id/main_graph"
     app:startDestination="@+id/homeFragment">
+
+
     <fragment
         android:id="@+id/nav_groups"
         android:name="com.geektechkb.feature_main.presentation.ui.fragments.group.GroupFragment"
@@ -29,6 +31,69 @@
             android:id="@+id/action_homeFragment_to_connectionCheckFragment"
             app:destination="@id/connectionCheckFragment" />
     </fragment>
+    <fragment
+        android:id="@+id/profileFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.profile.ProfileFragment"
+        android:label="fragment_profile"
+        tools:layout="@layout/fragment_profile">
+        <argument
+            android:name="croppedImage"
+            android:defaultValue="@null"
+            app:argType="string"
+            app:nullable="true" />
+        <action
+            android:id="@+id/action_profileFragment_to_cropPhotoFragment"
+            app:destination="@id/cropPhotoFragment" />
+        <action
+            android:id="@+id/action_profileFragment_to_chatFragment"
+            app:destination="@id/chatFragment" />
+
+        <action
+            android:id="@+id/action_profileFragment_to_languagesFragment"
+            app:destination="@id/languagesFragment" />
+        <action
+            android:id="@+id/action_profileFragment_to_notificationsAndSoundsFragment"
+            app:destination="@id/notificationsAndSoundsFragment" />
+        <action
+            android:id="@+id/action_profileFragment_to_editProfileFragment"
+            app:destination="@id/editProfileFragment" />
+        <action
+            android:id="@+id/action_profileFragment_to_homeFragment"
+            app:destination="@id/homeFragment" />
+
+    </fragment>
+    <dialog
+        android:id="@+id/galleryBottomSheetFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.gallerydialogbotomsheet.GalleryBottomSheetFragment"
+        android:label="fragment_gallery_bottom_sheet"
+        tools:layout="@layout/fragment_gallery_bottom_sheet">
+        <action
+            android:id="@+id/action_galleryBottomSheetFragment_to_cropPhotoFragment"
+            app:destination="@id/cropPhotoFragment" />
+    </dialog>
+    <fragment
+        android:id="@+id/cropPhotoFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.crop.CropPhotoFragment"
+        android:label="fragment_crop_photo"
+        tools:layout="@layout/fragment_crop_photo">
+        <argument
+            android:name="uri"
+            app:argType="string" />
+        <action
+            android:id="@+id/action_cropPhotoFragment_to_profileFragment"
+            app:destination="@id/profileFragment"
+            app:popUpTo="@id/main_graph"
+            app:popUpToInclusive="true" />
+        <action
+            android:id="@+id/action_cropPhotoFragment_to_editProfileFragment"
+            app:destination="@id/editProfileFragment"
+            app:popUpTo="@id/main_graph"
+            app:popUpToInclusive="true" />
+        <argument
+            android:name="whereToNavigateBack"
+            app:argType="com.geektechkb.feature_main.presentation.ui.models.enums.CropPhotoRequest" />
+    </fragment>
+
 
     <fragment
         android:id="@+id/chatFragment"
@@ -59,9 +124,7 @@
             app:destination="@id/photoReviewFragment" />
         <action
             android:id="@+id/action_chatFragment_to_homeFragment"
-            app:destination="@id/homeFragment"
-            app:popUpTo="@id/main_graph"
-            app:popUpToInclusive="true" />
+            app:destination="@id/homeFragment" />
     </fragment>
     <dialog
         android:id="@+id/deniedPermissionsDialogFragment"
@@ -94,7 +157,12 @@
             android:id="@+id/action_connectionCheckFragment_to_homeFragment"
             app:destination="@id/homeFragment" />
     </fragment>
-
+    <fragment
+        android:id="@+id/languagesFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.language.LanguagesFragment"
+        android:label="fragment_languages"
+        tools:layout="@layout/fragment_languages">
+    </fragment>
     <fragment
         android:id="@+id/voiceCallFragment"
         android:name="com.geektechkb.feature_main.presentation.ui.fragments.calls.voice.VoiceCallFragment"
@@ -118,9 +186,6 @@
         android:label="fragment_photo_preview"
         tools:layout="@layout/fragment_photo_preview">
         <argument
-            android:name="phoneNumber"
-            app:argType="string" />
-        <argument
             android:name="photo"
             app:argType="string" />
         <action
@@ -129,11 +194,23 @@
             app:popUpTo="@id/main_graph"
             app:popUpToInclusive="true" />
     </fragment>
-
-
     <fragment
-        android:id="@+id/profileFlowFragment"
-        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.ProfileFlowFragment"
-        android:label="ProfileFlowFragment"
-        tools:layout="@layout/fragment_profile_flow" />
+        android:id="@+id/notificationsAndSoundsFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.notificationsAndSounds.NotificationsAndSoundsFragment"
+        android:label="fragment_notifications_and_sounds"
+        tools:layout="@layout/fragment_notifications_and_sounds" />
+    <fragment
+        android:id="@+id/editProfileFragment"
+        android:name="com.geektechkb.feature_main.presentation.ui.fragments.profil.editProfile.EditProfileFragment"
+        android:label="fragment_edit_profile"
+        tools:layout="@layout/fragment_edit_profile">
+        <action
+            android:id="@+id/action_editProfileFragment_to_cropPhotoFragment"
+            app:destination="@id/cropPhotoFragment" />
+        <argument
+            android:name="croppedProfileAvatar"
+            android:defaultValue="@null"
+            app:argType="string"
+            app:nullable="true" />
+    </fragment>
 </navigation>
\ No newline at end of file
